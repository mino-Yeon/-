<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>순열 시뮬레이션 - 반복문 + 배열 + boolean</title>
<style>
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family:'Malgun Gothic','Apple SD Gothic Neo',sans-serif; background:#f0f2f5; color:#333; height:100vh; display:flex; flex-direction:column; }
.header { background:#2c3e50; color:#fff; padding:12px 24px; display:flex; align-items:center; gap:16px; }
.header h1 { font-size:18px; } .header .sub { font-size:13px; color:#94a3b8; }
.controls { background:#34495e; padding:10px 24px; display:flex; align-items:center; gap:8px; flex-wrap:wrap; }
.controls button { background:#3498db; color:#fff; border:none; padding:6px 14px; border-radius:4px; cursor:pointer; font-size:13px; font-family:inherit; }
.controls button:hover { background:#2980b9; }
.controls button.playing { background:#e74c3c; }
.sep { width:1px; height:24px; background:#4a6278; margin:0 4px; }
.controls label { color:#cbd5e1; font-size:13px; }
.controls input[type=range] { width:80px; vertical-align:middle; }
.step-info { color:#94a3b8; font-size:13px; margin-left:auto; }
.main { display:flex; flex:1; overflow:hidden; }
.code-panel { width:42%; min-width:340px; background:#1e1e1e; display:flex; flex-direction:column; border-right:2px solid #34495e; }
.panel-hd { background:#2d2d2d; color:#94a3b8; padding:8px 16px; font-size:12px; font-weight:600; border-bottom:1px solid #3d3d3d; }
.code-body { flex:1; overflow-y:auto; padding:8px 0; }
.cl { display:flex; padding:1px 0; font-family:'Consolas','D2Coding',monospace; font-size:14px; line-height:1.6; transition:background .15s; }
.cl.active { background:#264f78; }
.cl.skip-line { background:#4a2020; }
.cl.active .ln { color:#fff; }
.cl.skip-line .ln { color:#f87171; }
.ln { width:36px; text-align:right; padding-right:10px; color:#555; user-select:none; flex-shrink:0; }
.lc { color:#d4d4d4; white-space:pre; }
.kw { color:#569cd6; } .tp { color:#4ec9b0; } .nm { color:#b5cea8; } .st { color:#ce9178; } .cm { color:#6a9955; }
.viz-panel { flex:1; display:flex; flex-direction:column; overflow:hidden; }
.vs { border-bottom:1px solid #ddd; }
.vs .sh { background:#e8ecf0; padding:6px 16px; font-size:12px; font-weight:600; color:#64748b; }
.vs .sb { padding:12px 16px; background:#fff; }
.var-c { display:flex; gap:12px; flex-wrap:wrap; }
.vb { display:inline-flex; align-items:center; padding:6px 14px; border-radius:6px; font-size:15px; font-weight:600; font-family:'Consolas','D2Coding',monospace; }
.vi { background:#dbeafe; color:#1d4ed8; } .vj { background:#fce7f3; color:#be185d; } .vk { background:#d1fae5; color:#065f46; }
.rc { display:flex; align-items:flex-start; gap:4px; min-height:60px; flex-wrap:wrap; padding:4px 0; }
.rb { width:46px; text-align:center; }
.rb .box { width:46px; height:46px; display:flex; align-items:center; justify-content:center; border:2px solid #94a3b8; border-radius:8px; font-size:18px; font-weight:700; font-family:'Consolas','D2Coding',monospace; background:#f8fafc; transition:all .2s; }
.rb .idx { font-size:10px; color:#94a3b8; margin-top:2px; }
.rb.dim .box { color:#cbd5e1; border-color:#cbd5e1; background:#f1f5f9; }
.rb.set .box { border-color:#f59e0b; background:#fef3c7; color:#b45309; transform:scale(1.1); box-shadow:0 0 8px rgba(245,158,11,.4); }
/* isSelected 시각화 */
.bool-c { display:flex; gap:6px; flex-wrap:wrap; padding:4px 0; }
.bb { width:56px; text-align:center; }
.bb .box { width:56px; height:36px; display:flex; align-items:center; justify-content:center; border:2px solid #cbd5e1; border-radius:6px; font-size:13px; font-weight:700; font-family:'Consolas','D2Coding',monospace; background:#f8fafc; color:#94a3b8; transition:all .2s; }
.bb .idx { font-size:10px; color:#94a3b8; margin-top:2px; }
.bb.btrue .box { border-color:#22c55e; background:#dcfce7; color:#15803d; }
.bb.bsel .box { border-color:#22c55e; background:#bbf7d0; color:#15803d; transform:scale(1.08); box-shadow:0 0 8px rgba(34,197,94,.4); }
.bb.bdesel .box { border-color:#ef4444; background:#fee2e2; color:#dc2626; transform:scale(0.95); box-shadow:0 0 8px rgba(239,68,68,.3); }
.desc { font-size:15px; line-height:1.6; min-height:44px; display:flex; align-items:center; }
.ac-set { color:#d97706; font-weight:600; } .ac-pr { color:#2563eb; font-weight:600; } .ac-lp { color:#7c3aed; font-weight:600; }
.ac-skip { color:#ef4444; font-weight:600; } .ac-sel { color:#16a34a; font-weight:600; } .ac-desel { color:#dc2626; font-weight:600; }
.out-sec { flex:1; display:flex; flex-direction:column; }
.out-sec .sb { flex:1; display:flex; flex-direction:column; }
.ob { flex:1; overflow-y:auto; font-family:'Consolas','D2Coding',monospace; font-size:12px; line-height:1.5; max-height:180px; background:#1a1a2e; color:#a5f3fc; padding:8px 12px; border-radius:4px; }
.ob .new { color:#fbbf24; font-weight:600; }
.kbd-help { color:#64748b; font-size:11px; margin-left:12px; }
</style>
</head>
<body>
<div class="header">
  <h1>2. 순열 - 반복문 + 배열 + boolean</h1>
  <span class="sub">Perm_for_arr_boolean.java &nbsp;|&nbsp; arr = {3, 5, 7, 9}, N=4, R=3 (고정)</span>
</div>
<div class="controls">
  <button onclick="reset()">⏮ 처음</button>
  <button onclick="prev()">◀ 이전</button>
  <button id="playBtn" onclick="togglePlay()">▶ 재생</button>
  <button onclick="next()">다음 ▶</button>
  <div class="sep"></div>
  <button onclick="skipOut()">⏩ 다음 출력</button>
  <div class="sep"></div>
  <label>속도: <input type="range" id="spd" min="1" max="10" value="5" oninput="spVal=+this.value"></label>
  <span class="step-info" id="si">준비</span>
  <span class="kbd-help">키보드: ←→ 이전/다음 · Space 재생 · S 다음출력 · R 처음</span>
</div>
<div class="main">
  <div class="code-panel">
    <div class="panel-hd">Java Code</div>
    <div class="code-body" id="cb"></div>
  </div>
  <div class="viz-panel">
    <div class="vs"><div class="sh">변수 상태</div><div class="sb"><div class="var-c" id="vc"></div></div></div>
    <div class="vs"><div class="sh">result (int[3])</div><div class="sb"><div class="rc" id="rc"></div></div></div>
    <div class="vs"><div class="sh">isSelected (boolean[4])</div><div class="sb"><div class="bool-c" id="bc"></div></div></div>
    <div class="vs"><div class="sh">실행 설명</div><div class="sb"><div class="desc" id="dc">▶ 재생 또는 다음 버튼으로 시작하세요.</div></div></div>
    <div class="vs out-sec"><div class="sh">콘솔 출력 <span id="oc">(0개)</span></div><div class="sb"><div class="ob" id="ob"></div></div></div>
  </div>
</div>
<script>
const AA=[3,5,7,9];
const SRC=[
'package day0204;',
'',
'import java.util.Arrays;',
'',
'public class Perm_for_arr_boolean {',
'',
'    static int N = 4;    // 전체 요소의 개수',
'    static int[] arr = {3, 5, 7, 9};',
'    static int[] result = new int[3];',
'    static boolean[] isSelected = new boolean[N];',
'',
'    public static void main(String[] args) {',
'        for(int i=0; i<N; i++) {',
'            result[0] = arr[i];',
'            isSelected[i] = true;',
'',
'            for(int j=0; j<N; j++) {',
'                if(isSelected[j]) continue;',
'',
'                result[1] = arr[j];',
'                isSelected[j] = true;',
'                for(int k=0; k<N; k++) {',
'                    if(isSelected[k]) continue;',
'',
'                    result[2] = arr[k];',
'                    isSelected[k] = true;',
'                    System.out.println(Arrays.toString(result));',
'                    isSelected[k] = false;',
'                }',
'                isSelected[j] = false;',
'            }',
'            isSelected[i] = false;',
'        }',
'    }',
'}'
];
function hl(t){t=t.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');t=t.replace(/(\/\/.*)$/gm,'<span class="cm">$1</span>');t=t.replace(/"([^"]*)"/g,'<span class="st">"$1"</span>');t=t.replace(/\b(package|import|public|class|static|void|new|for|int|if|continue|return|boolean|true|false)\b/g,'<span class="kw">$1</span>');t=t.replace(/\b(String|Arrays|System)\b/g,'<span class="tp">$1</span>');t=t.replace(/\b(\d+)\b/g,'<span class="nm">$1</span>');return t;}
function initCode(){document.getElementById('cb').innerHTML=SRC.map((l,i)=>`<div class="cl" id="L${i+1}"><span class="ln">${i+1}</span><span class="lc">${hl(l)}</span></div>`).join('');}

function genSteps(){
  const A=[3,5,7,9],N=4,S=[];let R=[0,0,0],IS=[false,false,false,false],O=[];
  for(let i=0;i<N;i++){
    S.push({l:13,v:{i,j:'-',k:'-'},r:[...R],is:[...IS],o:[...O],a:'loop',d:`<span class="ac-lp">외부 for문</span>: i = ${i} (arr[${i}] = ${A[i]})`});
    R[0]=A[i];
    S.push({l:14,v:{i,j:'-',k:'-'},r:[...R],is:[...IS],o:[...O],a:'set',si:0,d:`<span class="ac-set">result[0]</span> = arr[${i}] → <b>${A[i]}</b>`});
    IS[i]=true;
    S.push({l:15,v:{i,j:'-',k:'-'},r:[...R],is:[...IS],o:[...O],a:'sel',bi:i,d:`<span class="ac-sel">isSelected[${i}]</span> = true → arr[${i}](=${A[i]}) 선택됨`});
    for(let j=0;j<N;j++){
      S.push({l:17,v:{i,j,k:'-'},r:[...R],is:[...IS],o:[...O],a:'loop',d:`<span class="ac-lp">중간 for문</span>: j = ${j} (arr[${j}] = ${A[j]})`});
      if(IS[j]){
        S.push({l:18,v:{i,j,k:'-'},r:[...R],is:[...IS],o:[...O],a:'skip',d:`<span class="ac-skip">continue</span>: isSelected[${j}] == true → 이미 선택됨, 건너뛰기`});
        continue;
      }
      R[1]=A[j];
      S.push({l:20,v:{i,j,k:'-'},r:[...R],is:[...IS],o:[...O],a:'set',si:1,d:`<span class="ac-set">result[1]</span> = arr[${j}] → <b>${A[j]}</b>`});
      IS[j]=true;
      S.push({l:21,v:{i,j,k:'-'},r:[...R],is:[...IS],o:[...O],a:'sel',bi:j,d:`<span class="ac-sel">isSelected[${j}]</span> = true → arr[${j}](=${A[j]}) 선택됨`});
      for(let k=0;k<N;k++){
        S.push({l:22,v:{i,j,k},r:[...R],is:[...IS],o:[...O],a:'loop',d:`<span class="ac-lp">내부 for문</span>: k = ${k} (arr[${k}] = ${A[k]})`});
        if(IS[k]){
          S.push({l:23,v:{i,j,k},r:[...R],is:[...IS],o:[...O],a:'skip',d:`<span class="ac-skip">continue</span>: isSelected[${k}] == true → 이미 선택됨, 건너뛰기`});
          continue;
        }
        R[2]=A[k];
        S.push({l:25,v:{i,j,k},r:[...R],is:[...IS],o:[...O],a:'set',si:2,d:`<span class="ac-set">result[2]</span> = arr[${k}] → <b>${A[k]}</b>`});
        IS[k]=true;
        S.push({l:26,v:{i,j,k},r:[...R],is:[...IS],o:[...O],a:'sel',bi:k,d:`<span class="ac-sel">isSelected[${k}]</span> = true → arr[${k}](=${A[k]}) 선택됨`});
        const ol='['+R.join(', ')+']';O.push(ol);
        S.push({l:27,v:{i,j,k},r:[...R],is:[...IS],o:[...O],a:'print',d:`<span class="ac-pr">출력</span>: ${ol} &nbsp; (${O.length}번째)`});
        IS[k]=false;
        S.push({l:28,v:{i,j,k},r:[...R],is:[...IS],o:[...O],a:'desel',bi:k,d:`<span class="ac-desel">isSelected[${k}]</span> = false → arr[${k}](=${A[k]}) 해제`});
      }
      IS[j]=false;
      S.push({l:30,v:{i,j,k:'-'},r:[...R],is:[...IS],o:[...O],a:'desel',bi:j,d:`<span class="ac-desel">isSelected[${j}]</span> = false → arr[${j}](=${A[j]}) 해제`});
    }
    IS[i]=false;
    S.push({l:32,v:{i,j:'-',k:'-'},r:[...R],is:[...IS],o:[...O],a:'desel',bi:i,d:`<span class="ac-desel">isSelected[${i}]</span> = false → arr[${i}](=${A[i]}) 해제`});
  }
  return S;
}

let steps=[],ci=-1,playing=false,timer=null,spVal=5;

function renderArr(r,setIdx){
  let h='';
  for(let idx=0;idx<3;idx++){
    let c='rb';
    if(setIdx===idx) c+=' set';
    else if(r[0]===0&&r[1]===0&&r[2]===0&&setIdx===-1) c+=' dim';
    h+=`<div class="${c}"><div class="box">${r[idx]}</div><div class="idx">[${idx}]</div></div>`;
  }
  return h;
}

function renderBool(is,highlightIdx,isSel){
  let h='';
  for(let idx=0;idx<4;idx++){
    let c='bb';
    if(idx===highlightIdx) c+=isSel?' bsel':' bdesel';
    else if(is[idx]) c+=' btrue';
    h+=`<div class="${c}"><div class="box">${is[idx]?'T':'F'}</div><div class="idx">[${idx}]=${AA[idx]}</div></div>`;
  }
  return h;
}

function render(){
  document.querySelectorAll('.cl.active,.cl.skip-line').forEach(e=>{e.classList.remove('active');e.classList.remove('skip-line');});
  if(ci>=0){
    const s=steps[ci];
    const el=document.getElementById('L'+s.l);
    if(el){
      el.classList.add(s.a==='skip'?'skip-line':'active');
      el.scrollIntoView({block:'nearest',behavior:'smooth'});
    }
  }
  if(ci<0){
    document.getElementById('vc').innerHTML='<span class="vb vi">i = -</span><span class="vb vj">j = -</span><span class="vb vk">k = -</span>';
    document.getElementById('rc').innerHTML=renderArr([0,0,0],-1);
    document.getElementById('bc').innerHTML=renderBool([false,false,false,false],-1,false);
    document.getElementById('dc').innerHTML='▶ 재생 또는 다음 버튼으로 시작하세요.';
    document.getElementById('ob').innerHTML='';
    document.getElementById('oc').textContent='(0개)';
    document.getElementById('si').textContent=`0 / ${steps.length}`;
    return;
  }
  const s=steps[ci];
  document.getElementById('vc').innerHTML=`<span class="vb vi">i = ${s.v.i}</span><span class="vb vj">j = ${s.v.j}</span><span class="vb vk">k = ${s.v.k}</span>`;
  const setIdx=s.a==='set'?s.si:-1;
  document.getElementById('rc').innerHTML=renderArr(s.r,setIdx);
  let bhi=-1,bsel=false;
  if(s.a==='sel'){bhi=s.bi;bsel=true;}
  else if(s.a==='desel'){bhi=s.bi;bsel=false;}
  document.getElementById('bc').innerHTML=renderBool(s.is,bhi,bsel);
  document.getElementById('dc').innerHTML=s.d;
  const ob=document.getElementById('ob');
  ob.innerHTML=s.o.map((l,i)=>`<div${i===s.o.length-1&&s.a==='print'?' class="new"':''}>${i+1}. ${l}</div>`).join('');
  ob.scrollTop=ob.scrollHeight;
  document.getElementById('oc').textContent=`(${s.o.length}개)`;
  document.getElementById('si').textContent=`${ci+1} / ${steps.length}`;
}

function reset(){stop();ci=-1;render();}
function prev(){stop();if(ci>-1){ci--;render();}}
function next(){if(ci<steps.length-1){ci++;render();}else stop();}
function togglePlay(){playing?stop():start();}
function start(){if(ci>=steps.length-1)ci=-1;playing=true;document.getElementById('playBtn').textContent='⏸ 정지';document.getElementById('playBtn').classList.add('playing');tick();}
function stop(){playing=false;clearTimeout(timer);timer=null;document.getElementById('playBtn').textContent='▶ 재생';document.getElementById('playBtn').classList.remove('playing');}
function tick(){if(!playing)return;const d=1100-spVal*100;timer=setTimeout(()=>{next();if(playing&&ci<steps.length-1)tick();else stop();},d);}
function skipOut(){stop();for(let i=ci+1;i<steps.length;i++){if(steps[i].a==='print'){ci=i;render();return;}}ci=steps.length-1;render();}

document.addEventListener('keydown',e=>{
  if(e.key==='ArrowRight'||e.key===' '){e.preventDefault();next();}
  else if(e.key==='ArrowLeft'){e.preventDefault();prev();}
  else if(e.key==='Enter'){e.preventDefault();togglePlay();}
  else if(e.key==='r'||e.key==='R')reset();
  else if(e.key==='s'||e.key==='S')skipOut();
});

initCode();steps=genSteps();render();
</script>
</body>
</html>
